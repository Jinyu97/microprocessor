; 토글스위치, 12개 LED 회전, 방향 변경


	PROCESSOR 16F876A

	#INCLUDE <P16F876A.INC>

; ---변수선언---
VARIABLE	LED1	= 	20H
VARIABLE	LED2	= 	21H
VARIABLE	DBUF1	=	22H
VARIABLE	DBUF2	=	23H


	ORG	0000
	BSF	STATUS, RP0
	MOVLW	B'00000000'
	MOVWF	TRISA
	MOVLW	B'00000001'
	MOVWF	TRISB
	MOVLW	B'00000000'
	MOVWF	TRISC
	MOVLW	B'00000111'
	MOVWF	ADCON1
	BCF	STATUS, RP0

;MAIN PROGRAM
MAIN
	MOVLW	01H
	ADDLW	00H
	MOVWF	LED1
	CLRF	LED2

CC

	BTFSC	PORTB, 0
	GOTO 	LEFT

RIGHT

	MOVF	LED1, W
	MOVWF	PORTC		;W을 PORTC에 출력
	MOVF	LED2, W
	MOVWF	PORTA		;W을 PORTA에 출력
	CALL	DELAY
	RRF	LED2, F 	;ROTATE 시킴
	RRF	LED1, F		;ROTATE 시킴	
	BTFSS	STATUS, C
	GOTO	CC

	MOVLW	08H
	ADDLW	00H
	MOVWF	LED2
	CLRF	LED1

	GOTO	CC
LEFT

	MOVF	LED1, W
	MOVWF	PORTC		;W을 PORTC에 출력
	MOVF	LED2, W
	MOVWF	PORTA		;W을 PORTA에 출력
	CALL	DELAY
	RLF	LED1, F 	;ROTATE 시킴
	RLF	LED2, F		;ROTATE 시킴	
	BTFSS	LED2, 4
	GOTO	CC
	GOTO	MAIN

; SUBROUTINE

DELAY	
	MOVLW	.125		;125번을 확인하기 위한 변수
	MOVWF	DBUF1
LP1	MOVLW	.200		;200번을 확인하기 위한 변수
	MOVWF	DBUF2
LP2	NOP
	DECFSZ	DBUF2, F
	GOTO	LP2
	DECFSZ	DBUF1, F	;변수를 감소시켜 가면서 00이 되었나 확인
	GOTO	LP1		;ZERO가 아니면 여기에 들어옴
	RETURN

	END

